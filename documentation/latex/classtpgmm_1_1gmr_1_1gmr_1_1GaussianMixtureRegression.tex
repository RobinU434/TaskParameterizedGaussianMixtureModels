\hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression}{}\doxysection{tpgmm.\+gmr.\+gmr.\+Gaussian\+Mixture\+Regression Class Reference}
\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression}\index{tpgmm.gmr.gmr.GaussianMixtureRegression@{tpgmm.gmr.gmr.GaussianMixtureRegression}}


This class implements a gaussian mixture regression model.  




Inheritance diagram for tpgmm.\+gmr.\+gmr.\+Gaussian\+Mixture\+Regression\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=294pt]{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for tpgmm.\+gmr.\+gmr.\+Gaussian\+Mixture\+Regression\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=294pt]{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a5c09b8566a6b31ec688989095e372675}\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a5c09b8566a6b31ec688989095e372675}} 
None {\bfseries \+\_\+\+\_\+init\+\_\+\+\_\+} (self, ndarray weights, ndarray means, ndarray covariances, Iterable\mbox{[}int\mbox{]} input\+\_\+idx)
\item 
\mbox{\Hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a5f1f4c7463a8fb917aaf51143c19502f}\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a5f1f4c7463a8fb917aaf51143c19502f}} 
\char`\"{}Gaussian\+Mixture\+Regression\char`\"{} {\bfseries from\+\_\+tpgmm} (\char`\"{}Gaussian\+Mixture\+Regression\char`\"{} cls, TPGMM tpgmm, Iterable\mbox{[}int\mbox{]} input\+\_\+idx)
\item 
None \mbox{\hyperlink{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a1a5dbdb5b5048178752bee22509d52be}{fit}} (self, ndarray translation, ndarray rotation\+\_\+matrix)
\begin{DoxyCompactList}\small\item\em Turns the task\+\_\+parameterized gaussian mixture model into a single gaussian mixture model. \end{DoxyCompactList}\item 
Tuple\mbox{[}ndarray, ndarray\mbox{]} \mbox{\hyperlink{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_af595b371d88d22f8cf6859638b6bafb4}{predict}} (self, ndarray input\+\_\+data)
\begin{DoxyCompactList}\small\item\em this function is inspired by formula 13 in Calinon paper it creates for each given data point its own parameterized gaussian distribution. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_ac25a223ccb2e3ea78fd151c8ccfec7ae}{num\+\_\+input\+\_\+features}} (self)
\begin{DoxyCompactList}\small\item\em get number of input features. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_afecd0a188d011d845529bc075db678d6}{num\+\_\+output\+\_\+features}} (self)
\begin{DoxyCompactList}\small\item\em get number of output features. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a5d4d1fe40d2a5ff60d09ad8e4d6b322b}\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a5d4d1fe40d2a5ff60d09ad8e4d6b322b}} 
List\mbox{[}int\mbox{]} {\bfseries output\+\_\+idx} (self)
\item 
\mbox{\Hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_af13c729a604b967f7d246867263aa45b}\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_af13c729a604b967f7d246867263aa45b}} 
Dict\mbox{[}str, Any\mbox{]} \mbox{\hyperlink{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_af13c729a604b967f7d246867263aa45b}{config}} (self)
\begin{DoxyCompactList}\small\item\em Get all model config parameters. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a557102416a207f1fc32f9f2b3aa51d11}\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a557102416a207f1fc32f9f2b3aa51d11}} 
{\bfseries tpgmm\+\_\+means\+\_\+}
\item 
\mbox{\Hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_abd94914a57447b45972d0b4409814769}\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_abd94914a57447b45972d0b4409814769}} 
{\bfseries tpgmm\+\_\+covariances\+\_\+}
\item 
\mbox{\Hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_aa5f0224beef6ce2ee979d9be2044a9a5}\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_aa5f0224beef6ce2ee979d9be2044a9a5}} 
{\bfseries gmm\+\_\+weights}
\item 
\mbox{\Hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a9627aa6fbcdc9952586704e15aab21ef}\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a9627aa6fbcdc9952586704e15aab21ef}} 
{\bfseries input\+\_\+idx}
\item 
\mbox{\Hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a737e80a68c0a81ff9318a8fc882bf14f}\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a737e80a68c0a81ff9318a8fc882bf14f}} 
{\bfseries xi\+\_\+}
\item 
\mbox{\Hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a6a362aa490e288b1402a4174f27f6bdf}\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a6a362aa490e288b1402a4174f27f6bdf}} 
{\bfseries sigma\+\_\+}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This class implements a gaussian mixture regression model. 

This model was described in \textquotesingle{}A Tutorial on Task-\/\+Parameterized Movement Learning and Retrival\textquotesingle{} from S.\+Calinon at\+: \href{https://calinon.ch/papers/Calinon-JIST2015.pdf}{\texttt{ https\+://calinon.\+ch/papers/\+Calinon-\/\+JIST2015.\+pdf}}

The class fits a gaussian mixture regression on a given Gaussian Mixture model or a Task-\/\+Parameterized gaussian mixture model. Used equations are\+: \[ \mathcal{P}(\phi_t^\mathcal{O}|\phi_t^\mathcal{I}) \sim \sum_{i=1}^K h_i(\phi_t^\mathcal{I}) \mathcal{N}\left(\hat{\mu}_t^\mathcal{O}(\phi_t^\mathcal{I}), \hat{\Sigma}_t^\mathcal{O}\right) \] \[ \hat{\mu}_i^\mathcal{O}(\phi_t^\mathcal{I}) = \mu_i^\mathcal{O} + \Sigma_i^\mathcal{OI}\Sigma_i^{\mathcal{I}, -1}(\phi_t^\mathcal{I} - \mu_i^\mathcal{I}) \] \[ \hat{\Sigma}_t^\mathcal{O} = \Sigma_i^\mathcal{O} - \Sigma_i^\mathcal{OI}\Sigma_i^{\mathcal{I}, -1}\Sigma_i^\mathcal{OI} \] \[ h_i(\phi_t^\mathcal{I}) = \frac{\pi_i \mathcal{N}(\phi_t^\mathcal{I} \mid \mu_i^\mathcal{I}, \Sigma_i^\mathcal{I})}{\sum_k^K \pi_k \mathcal{N}\mathcal(\phi_t^\mathcal{I} \mid \mu_k^\mathcal{I}, \Sigma_k^\mathcal{I})} \]

{\bfseries{Examples}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{>>> \textcolor{comment}{\# trajectory data in local reference frames with shape: (num\_reference\_frames, num\_points, 4)}}
\DoxyCodeLine{>>> \textcolor{comment}{\# last dimension could be for example: x, y, z, time}}
\DoxyCodeLine{>>> \textcolor{comment}{\# in case you got multiple trajectories: concatenate all of them in axis 1}}
\DoxyCodeLine{>>> trajectories = load\_trajectories()}
\DoxyCodeLine{>>> tpgmm = TPGMM(n\_components=5)}
\DoxyCodeLine{>>> tpgmm.fit(trajectories)}
\DoxyCodeLine{>>> \textcolor{comment}{\# gmr for the first reference frame}}
\DoxyCodeLine{>>> gmr = GaussianMixtureRegression(weights=tpgmm.weights\_, means=tpgmm.means\_[0], covariances=tpgmm.covariances\_[0], input\_idx=[3])}
\DoxyCodeLine{>>> gmr.fit(trajectory[0])}

\end{DoxyCode}
 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a1a5dbdb5b5048178752bee22509d52be}\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_a1a5dbdb5b5048178752bee22509d52be}} 
\index{tpgmm.gmr.gmr.GaussianMixtureRegression@{tpgmm.gmr.gmr.GaussianMixtureRegression}!fit@{fit}}
\index{fit@{fit}!tpgmm.gmr.gmr.GaussianMixtureRegression@{tpgmm.gmr.gmr.GaussianMixtureRegression}}
\doxysubsubsection{\texorpdfstring{fit()}{fit()}}
{\footnotesize\ttfamily  None tpgmm.\+gmr.\+gmr.\+Gaussian\+Mixture\+Regression.\+fit (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{ndarray}]{translation,  }\item[{ndarray}]{rotation\+\_\+matrix }\end{DoxyParamCaption})}



Turns the task\+\_\+parameterized gaussian mixture model into a single gaussian mixture model. 

\begin{DoxyVerb}   function is performing equation (5) and (6) from calinon paper
\end{DoxyVerb}
 TODO write formulas


\begin{DoxyParams}{Parameters}
{\em translation} & translation matrix for translating into desired frames. Shape (num\+\_\+frames, num\+\_\+output\+\_\+features) \\
\hline
{\em rotation\+\_\+matrix} & rotation matrix for rotating into desired frames. Shape (num\+\_\+frames, num\+\_\+output\+\_\+features, num\+\_\+output\+\_\+features) \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_ac25a223ccb2e3ea78fd151c8ccfec7ae}\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_ac25a223ccb2e3ea78fd151c8ccfec7ae}} 
\index{tpgmm.gmr.gmr.GaussianMixtureRegression@{tpgmm.gmr.gmr.GaussianMixtureRegression}!num\_input\_features@{num\_input\_features}}
\index{num\_input\_features@{num\_input\_features}!tpgmm.gmr.gmr.GaussianMixtureRegression@{tpgmm.gmr.gmr.GaussianMixtureRegression}}
\doxysubsubsection{\texorpdfstring{num\_input\_features()}{num\_input\_features()}}
{\footnotesize\ttfamily  int tpgmm.\+gmr.\+gmr.\+Gaussian\+Mixture\+Regression.\+num\+\_\+input\+\_\+features (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



get number of input features. 

\begin{DoxyParagraph}{Example}
if you have 4 features\+: x, y, z, time. You can define with input\+\_\+idx=\mbox{[}3\mbox{]} time as the input feature. This function will return then 1
\end{DoxyParagraph}
\begin{DoxyReturn}{Returns}


int number of input features 
\end{DoxyReturn}
\mbox{\Hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_afecd0a188d011d845529bc075db678d6}\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_afecd0a188d011d845529bc075db678d6}} 
\index{tpgmm.gmr.gmr.GaussianMixtureRegression@{tpgmm.gmr.gmr.GaussianMixtureRegression}!num\_output\_features@{num\_output\_features}}
\index{num\_output\_features@{num\_output\_features}!tpgmm.gmr.gmr.GaussianMixtureRegression@{tpgmm.gmr.gmr.GaussianMixtureRegression}}
\doxysubsubsection{\texorpdfstring{num\_output\_features()}{num\_output\_features()}}
{\footnotesize\ttfamily  int tpgmm.\+gmr.\+gmr.\+Gaussian\+Mixture\+Regression.\+num\+\_\+output\+\_\+features (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



get number of output features. 

\begin{DoxyParagraph}{Example}
if you have 4 features\+: x, y, z, time. You can define with input\+\_\+idx=\mbox{[}3\mbox{]} time as the input feature. This function will return then 3 for x,y and z
\end{DoxyParagraph}
\begin{DoxyReturn}{Returns}


int number of output features 
\end{DoxyReturn}
\mbox{\Hypertarget{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_af595b371d88d22f8cf6859638b6bafb4}\label{classtpgmm_1_1gmr_1_1gmr_1_1GaussianMixtureRegression_af595b371d88d22f8cf6859638b6bafb4}} 
\index{tpgmm.gmr.gmr.GaussianMixtureRegression@{tpgmm.gmr.gmr.GaussianMixtureRegression}!predict@{predict}}
\index{predict@{predict}!tpgmm.gmr.gmr.GaussianMixtureRegression@{tpgmm.gmr.gmr.GaussianMixtureRegression}}
\doxysubsubsection{\texorpdfstring{predict()}{predict()}}
{\footnotesize\ttfamily  Tuple\mbox{[}ndarray, ndarray\mbox{]} tpgmm.\+gmr.\+gmr.\+Gaussian\+Mixture\+Regression.\+predict (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{ndarray}]{input\+\_\+data }\end{DoxyParamCaption})}



this function is inspired by formula 13 in Calinon paper it creates for each given data point its own parameterized gaussian distribution. 

The mechanics are described by\+: \[ \mathcal{P}(\phi_t^\mathcal{O}|\phi_t^\mathcal{I}) \sim \sum_{i=1}^K h_i(\phi_t^\mathcal{I}) \mathcal{N}\left(\hat{\mu}_t^\mathcal{O}(\phi_t^\mathcal{I}), \hat{\Sigma}_t^\mathcal{O}\right) \] in\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{self.h()}

\end{DoxyCode}
 \[ h_i(\phi_t^\mathcal{I}) = \frac{\pi_i \mathcal{N}(\phi_t^\mathcal{I} \mid \mu_i^\mathcal{I}, \Sigma_i^\mathcal{I})}{\sum_k^K \pi_k \mathcal{N}\mathcal(\phi_t^\mathcal{I} \mid \mu_k^\mathcal{I}, \Sigma_k^\mathcal{I})} \] in\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{self.mu\_hat()}

\end{DoxyCode}
 \[ \hat{\mu}_i^\mathcal{O}(\phi_t^\mathcal{I}) = \mu_i^\mathcal{O} + \Sigma_i^\mathcal{OI}\Sigma_i^{\mathcal{I}, -1}(\phi_t^\mathcal{I} - \mu_i^\mathcal{I}) \] in\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{self.sigma\_hat()}

\end{DoxyCode}
 \[ \hat{\Sigma}_t^\mathcal{O} = \Sigma_i^\mathcal{O} - \Sigma_i^\mathcal{OI}\Sigma_i^{\mathcal{I}, -1}\Sigma_i^\mathcal{OI} \]


\begin{DoxyParams}{Parameters}
{\em data} & Shape\+: (num\+\_\+points, num\+\_\+input\+\_\+features)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Tuple\mbox{[}ndarray, ndarray\mbox{]} \+: mu\+: shape -\/$>$ (num\+\_\+points, num\+\_\+output\+\_\+features), cov\+: shape (num\+\_\+points, num\+\_\+output\+\_\+features, num\+\_\+output\+\_\+features) 
\end{DoxyReturn}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
documentation/tmp/tpgmm/gmr/gmr.\+py\end{DoxyCompactItemize}
