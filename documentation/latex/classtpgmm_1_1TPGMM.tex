\hypertarget{classtpgmm_1_1TPGMM}{}\doxysection{tpgmm.\+TPGMM Class Reference}
\label{classtpgmm_1_1TPGMM}\index{tpgmm.TPGMM@{tpgmm.TPGMM}}


This class in an implementation of the task parameterized gaussian mixture model according to Calinon Paper @https\+://calinon.ch/papers/\+Calinon-\/\+JIST2015.\+pdf.  




Inheritance diagram for tpgmm.\+TPGMM\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=288pt]{classtpgmm_1_1TPGMM__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for tpgmm.\+TPGMM\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=288pt]{classtpgmm_1_1TPGMM__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
None \mbox{\hyperlink{classtpgmm_1_1TPGMM_a40036ee500d255d89427810a6d83f40b}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, int n\+\_\+components, float threshold=1e-\/7, int max\+\_\+iter=100, int min\+\_\+iter=5, ndarray weights\+\_\+init=None, ndarray means\+\_\+init=None, float reg\+\_\+factor=1e-\/5, bool verbose=False)
\begin{DoxyCompactList}\small\item\em Initialize the \mbox{\hyperlink{classtpgmm_1_1TPGMM}{TPGMM}} class. \end{DoxyCompactList}\item 
None \mbox{\hyperlink{classtpgmm_1_1TPGMM_af35fed3e9dc0208f24a89f00f6122417}{fit}} (self, ndarray X)
\begin{DoxyCompactList}\small\item\em fits X on the task parameterized gaussian mixture model using K-\/\+Means clustering as default initialization method and executes the expectation maximization algorithm\+: ~\newline
 E-\/\+Step\+: \end{DoxyCompactList}\item 
ndarray \mbox{\hyperlink{classtpgmm_1_1TPGMM_a59e8b02adf78abeab4341a5a35077c6a}{predict}} (self, ndarray X)
\begin{DoxyCompactList}\small\item\em predict cluster labels for each data point in X \end{DoxyCompactList}\item 
ndarray \mbox{\hyperlink{classtpgmm_1_1TPGMM_aeb60a978e9988f5bfbbb462ee242ce57}{predict\+\_\+proba}} (self, ndarray X)
\begin{DoxyCompactList}\small\item\em predict cluster labels for each data point \end{DoxyCompactList}\item 
float \mbox{\hyperlink{classtpgmm_1_1TPGMM_ab67d18e9b6c678d328a0ec96cc38091e}{silhouette\+\_\+score}} (self, ndarray X)
\begin{DoxyCompactList}\small\item\em calculated the silhouette score of the model over the given metric and given data x TODO(\+Marco Todescato)\+: please review this function if the merge for the silhouette score is correct \end{DoxyCompactList}\item 
float \mbox{\hyperlink{classtpgmm_1_1TPGMM_a6f2a0ec180d5c5887725c22825299ee8}{score}} (self, ndarray X)
\begin{DoxyCompactList}\small\item\em calculate log likelihood score given data \end{DoxyCompactList}\item 
float \mbox{\hyperlink{classtpgmm_1_1TPGMM_a8cc497729a854be807655dd1b882ca39}{bic}} (self, ndarray X)
\begin{DoxyCompactList}\small\item\em calculates the bayesian information criterion as in \end{DoxyCompactList}\item 
ndarray \mbox{\hyperlink{classtpgmm_1_1TPGMM_a8463d563adb49f0a7f426cbadfaac173}{gauss\+\_\+cdf}} (self, ndarray X)
\begin{DoxyCompactList}\small\item\em calculate the gaussian probability for a given data set. \end{DoxyCompactList}\item 
Dict\mbox{[}str, Any\mbox{]} \mbox{\hyperlink{classtpgmm_1_1TPGMM_a1e1c7219424eb82570dd6a515abb6dc4}{config}} (self)
\begin{DoxyCompactList}\small\item\em Returns a dictionary containing the configuration parameters of the \mbox{\hyperlink{classtpgmm_1_1TPGMM}{TPGMM}} model. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classtpgmm_1_1TPGMM_a9673858e6a24a87e2a8c766325b7360c}\label{classtpgmm_1_1TPGMM_a9673858e6a24a87e2a8c766325b7360c}} 
\mbox{\hyperlink{classtpgmm_1_1TPGMM_a9673858e6a24a87e2a8c766325b7360c}{weights\+\_\+}}
\begin{DoxyCompactList}\small\item\em ndarray of shape (n\+\_\+components,) Weights between gaussian components. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classtpgmm_1_1TPGMM_a54248b0297f941859f0cc7903ea642c5}\label{classtpgmm_1_1TPGMM_a54248b0297f941859f0cc7903ea642c5}} 
\mbox{\hyperlink{classtpgmm_1_1TPGMM_a54248b0297f941859f0cc7903ea642c5}{means\+\_\+}}
\begin{DoxyCompactList}\small\item\em ndarray of shape (num\+\_\+frames, n\+\_\+components, num\+\_\+features) Mean matrix for each frame and component. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classtpgmm_1_1TPGMM_a4f85685cd9bb342c7dbd59e24c2b46cc}{covariances\+\_\+}}
\begin{DoxyCompactList}\small\item\em ndarray of shape (num\+\_\+frames, n\+\_\+components, num\+\_\+features, num\+\_\+features). \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This class in an implementation of the task parameterized gaussian mixture model according to Calinon Paper @https\+://calinon.ch/papers/\+Calinon-\/\+JIST2015.\+pdf. 

It implements also an Expectation Maximization Algorithm with\+: ~\newline
 E-\/\+Step\+: \[ h_{t, i} = \frac{\pi_i \prod_{j=1}^P \mathcal{N}\left(X_t^{(j)} \mid \mu_i^{(j)}, \Sigma_i^{(j)}\right)}{\sum_{k=1}^K \pi_k \prod_{j=1}^P \mathcal{N}\left(X_t^{(j)} \mid \mu_k^{(j)}, \Sigma_k^{(j)}\right)} \]

M-\/\+Step\+: \[ \pi_i \leftarrow \frac{\sum_{t=1}^N h_{t, i}}{N} \] \[ \mu_i^{(j)} \leftarrow \frac{\sum_{t=1}^N h_{t, i} X_t^{(j)}}{\sum_{t=1}^N h_{t, i}} \] \[ \Sigma_i^{(j)} \leftarrow \frac{\sum_{t=1}^N h_{t, i} \left(X_t^{(j)} - \mu_i^{(j)}\right)\left(X_t^{(j)} - \mu_i^{(j)}\right)^T}{\sum_{t=1}^N h_{t, i}} \]

The optimization criterion is the log-\/likelihood implemented with\+: \[ LL = \frac{\sum_{t=1}^N \log\left(\sum_{k=1}^K \pi_k \prod_{j=1}^J\mathcal{N}\left(X_t^{(j)} \mid \mu_k^{(j)}, \Sigma_k^{(j)}\right)\right)}{N} \]

Variable explanation\+:~\newline
 $N$ ... number of components~\newline
 $\pi$ ... weights between components~\newline
 $i$ ... component index~\newline
 $j$ ... frame index (like pick or place frame)~\newline
 $\mu$ ... mean~\newline
 $\Sigma$ ... variance / covariance matrix~\newline
 $LL$ ... log likelihood

{\bfseries{Examples}} 
\begin{DoxyCode}{0}
\DoxyCodeLine{>>> trajectories = load\_trajectories()  \textcolor{comment}{\# trajectory data in local reference frames with shape: (num\_reference\_frames, num\_points, 3)}}
\DoxyCodeLine{>>> tpgmm = TPGMM(n\_components=5)}
\DoxyCodeLine{>>> tpgmm.fit(trajectories)}

\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em n\+\_\+components} & number of components \\
\hline
{\em tol} & threshold to break from EM algorithm. Defaults to 1e-\/3. \\
\hline
{\em max\+\_\+iter} & maximum number of iterations to perform the expectation maximization algorithm. Defaults to 100. \\
\hline
{\em min\+\_\+iter} & minimum number of iterations to perform the expectation maximization algorithm. Defaults to 5. \\
\hline
{\em weights\+\_\+init} & initial weights between each component. If set replaces initialization from K-\/\+Means. Defaults to None. \\
\hline
{\em means\+\_\+init} & initial means between each component. If set replaces initialization from K-\/\+Means. Defaults to None. \\
\hline
{\em reg\+\_\+factor} & regularization factor for empirical covariance matrix. Defaults to 1e-\/5. \\
\hline
{\em verbose} & Triggers print of learning stats. Defaults to False. \\
\hline
\end{DoxyParams}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classtpgmm_1_1TPGMM_a40036ee500d255d89427810a6d83f40b}\label{classtpgmm_1_1TPGMM_a40036ee500d255d89427810a6d83f40b}} 
\index{tpgmm.TPGMM@{tpgmm.TPGMM}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!tpgmm.TPGMM@{tpgmm.TPGMM}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily  None tpgmm.\+TPGMM.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{int}]{n\+\_\+components,  }\item[{float }]{threshold = {\ttfamily 1e-\/7},  }\item[{int }]{max\+\_\+iter = {\ttfamily 100},  }\item[{int }]{min\+\_\+iter = {\ttfamily 5},  }\item[{ndarray }]{weights\+\_\+init = {\ttfamily None},  }\item[{ndarray }]{means\+\_\+init = {\ttfamily None},  }\item[{float }]{reg\+\_\+factor = {\ttfamily 1e-\/5},  }\item[{bool }]{verbose = {\ttfamily False} }\end{DoxyParamCaption})}



Initialize the \mbox{\hyperlink{classtpgmm_1_1TPGMM}{TPGMM}} class. 


\begin{DoxyParams}{Parameters}
{\em n\+\_\+components} & Number of Gaussian multidimensional distributions to mix. \\
\hline
{\em threshold} & Threshold to break from EM algorithm. Defaults to 1e-\/3. \\
\hline
{\em max\+\_\+iter} & Maximum number of iterations to perform the expectation maximization algorithm. Defaults to 100. \\
\hline
{\em min\+\_\+iter} & Minimum number of iterations to perform the expectation maximization algorithm. Defaults to 5. \\
\hline
{\em weights\+\_\+init} & Initial weights between each component. If set, it replaces initialization from K-\/\+Means. Defaults to None. \\
\hline
{\em means\+\_\+init} & Initial means between each component. If set, it replaces initialization from K-\/\+Means. Defaults to None. \\
\hline
{\em reg\+\_\+factor} & Regularization factor for the empirical covariance matrix. Defaults to 1e-\/5. \\
\hline
{\em verbose} & Triggers print of learning stats. Defaults to False. \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classtpgmm_1_1TPGMM_a8cc497729a854be807655dd1b882ca39}\label{classtpgmm_1_1TPGMM_a8cc497729a854be807655dd1b882ca39}} 
\index{tpgmm.TPGMM@{tpgmm.TPGMM}!bic@{bic}}
\index{bic@{bic}!tpgmm.TPGMM@{tpgmm.TPGMM}}
\doxysubsubsection{\texorpdfstring{bic()}{bic()}}
{\footnotesize\ttfamily  float tpgmm.\+TPGMM.\+bic (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{ndarray}]{X }\end{DoxyParamCaption})}



calculates the bayesian information criterion as in 

\begin{DoxyVerb}   https://scikit-learn.org/stable/modules/linear_model.html#aic-bic
\end{DoxyVerb}



\begin{DoxyParams}{Parameters}
{\em X} & data tensor with expected shape (num\+\_\+frames, num\+\_\+points, num\+\_\+features)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}


float bic score 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classtpgmm_1_1utils_1_1learning__modules_1_1ClassificationModule_a7f5ee6753bc99c72fccf00dcd14532e8}{tpgmm.\+utils.\+learning\+\_\+modules.\+Classification\+Module}}.

\mbox{\Hypertarget{classtpgmm_1_1TPGMM_a1e1c7219424eb82570dd6a515abb6dc4}\label{classtpgmm_1_1TPGMM_a1e1c7219424eb82570dd6a515abb6dc4}} 
\index{tpgmm.TPGMM@{tpgmm.TPGMM}!config@{config}}
\index{config@{config}!tpgmm.TPGMM@{tpgmm.TPGMM}}
\doxysubsubsection{\texorpdfstring{config()}{config()}}
{\footnotesize\ttfamily  Dict\mbox{[}str, Any\mbox{]} tpgmm.\+TPGMM.\+config (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Returns a dictionary containing the configuration parameters of the \mbox{\hyperlink{classtpgmm_1_1TPGMM}{TPGMM}} model. 

\begin{DoxyReturn}{Returns}
Dict\mbox{[}str, Any\mbox{]}\+: Dictionary containing the configuration parameters. 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classtpgmm_1_1utils_1_1learning__modules_1_1ClassificationModule_a6338f01b3f0cf2f3b69a02ea27045e53}{tpgmm.\+utils.\+learning\+\_\+modules.\+Classification\+Module}}.

\mbox{\Hypertarget{classtpgmm_1_1TPGMM_af35fed3e9dc0208f24a89f00f6122417}\label{classtpgmm_1_1TPGMM_af35fed3e9dc0208f24a89f00f6122417}} 
\index{tpgmm.TPGMM@{tpgmm.TPGMM}!fit@{fit}}
\index{fit@{fit}!tpgmm.TPGMM@{tpgmm.TPGMM}}
\doxysubsubsection{\texorpdfstring{fit()}{fit()}}
{\footnotesize\ttfamily  None tpgmm.\+TPGMM.\+fit (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{ndarray}]{X }\end{DoxyParamCaption})}



fits X on the task parameterized gaussian mixture model using K-\/\+Means clustering as default initialization method and executes the expectation maximization algorithm\+: ~\newline
 E-\/\+Step\+: 


\begin{DoxyCode}{0}
\DoxyCodeLine{self.\_update\_h()}

\end{DoxyCode}
 M-\/\+Step\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{self.\_update\_weights\_()}
\DoxyCodeLine{self.\_update\_means\_()}
\DoxyCodeLine{self.\_update\_covariances()}

\end{DoxyCode}
 The optimization criterion is the log-\/likelihood implemented in\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{self.\_log\_likelihood()}

\end{DoxyCode}
 The algorithm stops if $LL_{t-1} - LL_t < \textit{self.tol}$ with $LL_{t}$ as the log-\/likelihood at time t.


\begin{DoxyParams}{Parameters}
{\em X} & data tensor to fit the the task parameterized gaussian mixture model on. Expected shape\+: (num\+\_\+frames, num\+\_\+points, num\+\_\+features) \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classtpgmm_1_1TPGMM_a8463d563adb49f0a7f426cbadfaac173}\label{classtpgmm_1_1TPGMM_a8463d563adb49f0a7f426cbadfaac173}} 
\index{tpgmm.TPGMM@{tpgmm.TPGMM}!gauss\_cdf@{gauss\_cdf}}
\index{gauss\_cdf@{gauss\_cdf}!tpgmm.TPGMM@{tpgmm.TPGMM}}
\doxysubsubsection{\texorpdfstring{gauss\_cdf()}{gauss\_cdf()}}
{\footnotesize\ttfamily  ndarray tpgmm.\+TPGMM.\+gauss\+\_\+cdf (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{ndarray}]{X }\end{DoxyParamCaption})}



calculate the gaussian probability for a given data set. 

\[ \mathcal{N}\left(X_t^{(j)} \mid \mu_i^{(j)}, \Sigma_i^{(j)}\right) = \frac{1}{\sqrt{(2\pi)^D|\Sigma_i^{(j)}|}} \exp \left( \frac{1}{2}(X_t^{(j)} - \mu_i^{(j)})\Sigma_i^{(j), -1}(X_t^{(j)} - \mu_i^{(j)})^T\right) \]

Variable explanation\+: D ... number of features


\begin{DoxyParams}{Parameters}
{\em X} & data with shape\+: (num\+\_\+frames, num\+\_\+points, num\+\_\+features)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}


ndarray probability shape (num\+\_\+frames, n\+\_\+components, num\+\_\+points) 
\end{DoxyReturn}
\mbox{\Hypertarget{classtpgmm_1_1TPGMM_a59e8b02adf78abeab4341a5a35077c6a}\label{classtpgmm_1_1TPGMM_a59e8b02adf78abeab4341a5a35077c6a}} 
\index{tpgmm.TPGMM@{tpgmm.TPGMM}!predict@{predict}}
\index{predict@{predict}!tpgmm.TPGMM@{tpgmm.TPGMM}}
\doxysubsubsection{\texorpdfstring{predict()}{predict()}}
{\footnotesize\ttfamily  ndarray tpgmm.\+TPGMM.\+predict (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{ndarray}]{X }\end{DoxyParamCaption})}



predict cluster labels for each data point in X 


\begin{DoxyParams}{Parameters}
{\em X} & data in local reference frames. Shape (num\+\_\+frames, num\+\_\+points, num\+\_\+features)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}


ndarray the label for each data-\/point. Shape (num\+\_\+points) 
\end{DoxyReturn}
\mbox{\Hypertarget{classtpgmm_1_1TPGMM_aeb60a978e9988f5bfbbb462ee242ce57}\label{classtpgmm_1_1TPGMM_aeb60a978e9988f5bfbbb462ee242ce57}} 
\index{tpgmm.TPGMM@{tpgmm.TPGMM}!predict\_proba@{predict\_proba}}
\index{predict\_proba@{predict\_proba}!tpgmm.TPGMM@{tpgmm.TPGMM}}
\doxysubsubsection{\texorpdfstring{predict\_proba()}{predict\_proba()}}
{\footnotesize\ttfamily  ndarray tpgmm.\+TPGMM.\+predict\+\_\+proba (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{ndarray}]{X }\end{DoxyParamCaption})}



predict cluster labels for each data point 


\begin{DoxyParams}{Parameters}
{\em X} & data in local reference frames. Shape (num\+\_\+frames, num\+\_\+points, num\+\_\+features)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}


ndarray cluster probabilities for each data\+\_\+point. Shape\+: (num\+\_\+points, num\+\_\+components) 
\end{DoxyReturn}
\mbox{\Hypertarget{classtpgmm_1_1TPGMM_a6f2a0ec180d5c5887725c22825299ee8}\label{classtpgmm_1_1TPGMM_a6f2a0ec180d5c5887725c22825299ee8}} 
\index{tpgmm.TPGMM@{tpgmm.TPGMM}!score@{score}}
\index{score@{score}!tpgmm.TPGMM@{tpgmm.TPGMM}}
\doxysubsubsection{\texorpdfstring{score()}{score()}}
{\footnotesize\ttfamily  float tpgmm.\+TPGMM.\+score (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{ndarray}]{X }\end{DoxyParamCaption})}



calculate log likelihood score given data 


\begin{DoxyParams}{Parameters}
{\em X} & data tensor with expected shape (num\+\_\+frames, num\+\_\+points, num\+\_\+features)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}


float log likelihood of given data 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classtpgmm_1_1utils_1_1learning__modules_1_1ClassificationModule_a60561407dd19bfc69854816478e7685a}{tpgmm.\+utils.\+learning\+\_\+modules.\+Classification\+Module}}.

\mbox{\Hypertarget{classtpgmm_1_1TPGMM_ab67d18e9b6c678d328a0ec96cc38091e}\label{classtpgmm_1_1TPGMM_ab67d18e9b6c678d328a0ec96cc38091e}} 
\index{tpgmm.TPGMM@{tpgmm.TPGMM}!silhouette\_score@{silhouette\_score}}
\index{silhouette\_score@{silhouette\_score}!tpgmm.TPGMM@{tpgmm.TPGMM}}
\doxysubsubsection{\texorpdfstring{silhouette\_score()}{silhouette\_score()}}
{\footnotesize\ttfamily  float tpgmm.\+TPGMM.\+silhouette\+\_\+score (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{ndarray}]{X }\end{DoxyParamCaption})}



calculated the silhouette score of the model over the given metric and given data x TODO(\+Marco Todescato)\+: please review this function if the merge for the silhouette score is correct 


\begin{DoxyParams}{Parameters}
{\em X} & data in expected shape\+: (num\+\_\+frames, num\+\_\+points, num\+\_\+features) \\
\hline
{\em metric} & {\itshape description}. Defaults to \char`\"{}euclidean\char`\"{}. \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{classtpgmm_1_1utils_1_1learning__modules_1_1ClassificationModule_a80d1119da921cb965657f64ae0f3c66b}{tpgmm.\+utils.\+learning\+\_\+modules.\+Classification\+Module}}.



\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classtpgmm_1_1TPGMM_a4f85685cd9bb342c7dbd59e24c2b46cc}\label{classtpgmm_1_1TPGMM_a4f85685cd9bb342c7dbd59e24c2b46cc}} 
\index{tpgmm.TPGMM@{tpgmm.TPGMM}!covariances\_@{covariances\_}}
\index{covariances\_@{covariances\_}!tpgmm.TPGMM@{tpgmm.TPGMM}}
\doxysubsubsection{\texorpdfstring{covariances\_}{covariances\_}}
{\footnotesize\ttfamily tpgmm.\+TPGMM.\+covariances\+\_\+}



ndarray of shape (num\+\_\+frames, n\+\_\+components, num\+\_\+features, num\+\_\+features). 

Covariance matrix for each frame and component 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
documentation/tmp/tpgmm/tpgmm/tpgmm.\+py\end{DoxyCompactItemize}
